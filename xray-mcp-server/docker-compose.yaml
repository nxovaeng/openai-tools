services:
  xray-allinone:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: xray-allinone
    network_mode: host  # Use host network for easy integration with other services
    volumes:
      - ./.env:/app/.env # API key
      - ./data:/app/data # Persistent data directory (configs, logs, etc)
    restart: unless-stopped
    environment:
      - TZ=Asia/Shanghai
      - DEPLOYMENT_MODE=container
      - XRAY_CONFIG_PATH=/app/data/xray/config.json
      - CADDY_CONFIG_PATH=/app/data/caddy/Caddyfile
      - CADDY_CONF_D_PATH=/app/data/caddy/conf.d
